#!/usr/bin/env bash
set -euo pipefail

ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
PLUGIN_DIR="$ROOT/tools/claude-sdlc-plugin"

if ! command -v claude >/dev/null 2>&1; then
  echo "error: 'claude' CLI not found in PATH" >&2
  echo "install Claude Code, then re-run this command" >&2
  exit 127
fi

if [ ! -f "$PLUGIN_DIR/.claude-plugin/plugin.json" ]; then
  echo "error: SDLC plugin not initialized (missing $PLUGIN_DIR/.claude-plugin/plugin.json)" >&2
  echo "run: git submodule update --init --recursive" >&2
  exit 2
fi

exec claude --plugin-dir "$PLUGIN_DIR" "$@"

